var f=null;function h(a){return function(b){this[a]=b}}
function s(a){this.N={ui:s.Mg,swfPath:"lib/",preferredFrameRate:60,fpsInterval:500,showDisplay:!0,emulateSound:!1,sampleRate:44100,CPU_FREQ_NTSC:1789772.5,CPU_FREQ_PAL:1773447.4};if(typeof a!="undefined")for(var b in this.N)typeof a[b]!="undefined"&&(this.N[b]=a[b]);this.Zb=1E3/this.N.preferredFrameRate;this.ui=new this.N.ui(this);this.i=new s.tb(this);this.q=new s.ca(this);this.G=new s.ba(this);this.m=f;this.Xc=new s.mc;this.ui.updateStatus("Ready to load a ROM.")}s.VERSION="{%= version %}";
s.prototype={ac:!1,Rc:0,Oe:!0,ed:f,reset:function(){this.m!==f&&this.m.reset();this.i.reset();this.q.reset();this.G.reset()},start:function(){var a=this;if(this.c!==f&&this.c.Rb){if(!this.ac)this.ac=!0,this.Nh=setInterval(function(){a.frame()},this.Zb/2),this.lg(),this.Ue(),this.fpsInterval=setInterval(function(){a.Ue()},this.N.fpsInterval)}else this.ui.updateStatus("There is no ROM loaded, or it is invalid.")},frame:function(){this.q.Ii();var a=0,b=this.N.emulateSound,c=this.i,e=this.q,g=this.G;
a:for(;;){c.bb===0?(a=c.Jh(),b&&g.ze(a),a*=3):c.bb>8?(a=24,b&&g.ze(8),c.bb-=8):(a=c.bb*3,b&&g.ze(c.bb),c.bb=0);for(;a>0;--a){e.Vb===e.La&&e.Ta===1&&e.K-21===e.Ma&&e.kd(e.Kf,!0);if(e.dd&&(--e.Zc,e.Zc===0)){e.dd=!1;e.Ji();break a}++e.Vb;if(e.Vb===341)e.Vb=0,e.Mh()}}if(this.Oe&&this.Me)for(;+new Date-this.Me<this.Zb;);++this.Rc;this.Me=+new Date},Ue:function(){var a=+new Date,b="Running";this.Le&&(b+=": "+(this.Rc/((a-this.Le)/1E3)).toFixed(2)+" FPS");this.ui.updateStatus(b);this.Rc=0;this.Le=a},stop:function(){clearInterval(this.Nh);
clearInterval(this.fpsInterval);this.ac=!1},hg:function(){this.ed!==f&&this.Ud(this.ed)},Ud:function(a){this.ac&&this.stop();this.ui.updateStatus("Loading ROM...");this.c=new s.If(this);this.c.load(a);if(this.c.Rb){this.reset();this.m=this.c.Dh();if(!this.m)return;this.m.vc();this.q.zc(this.c.Uh());this.ed=a;this.ui.updateStatus("Successfully loaded. Ready to be started.")}else this.ui.updateStatus("Invalid ROM!");return this.c.Rb},lg:function(){this.Le=f;this.Rc=0},xi:function(a){this.N.preferredFrameRate=
a;this.Zb=1E3/a;this.G.ej(this.N.sampleRate,!1)},yi:function(a){this.Oe=a;this.Me=f},toJSON:function(){return{romData:this.ed,cpu:this.i.toJSON(),mmap:this.m.toJSON(),ppu:this.q.toJSON()}},F:function(a){this.Ud(a.romData);this.i.F(a.cpu);this.m.F(a.mmap);this.q.F(a.ppu)}};s.Ca={pc:function(a,b,c,e,g){for(var d=0;d<g;++d)c[e+d]=a[b+d]},Wi:function(a){for(var b=Array(a.length),c=0;c<a.length;++c)b[c]=a[c];return b},F:function(a,b){for(var c in a.Ub)a.Ub.hasOwnProperty(c)&&(a[c]=b[a.Ub[c]])},toJSON:function(a){var b={},c;for(c in a.Ub)a.Ub.hasOwnProperty(c)&&(b[a.Ub[c]]=a[c]);return b},ei:function(){return/msie/i.test(navigator.userAgent)&&!/opera/i.test(navigator.userAgent)}};s.tb=function(a){this.a=a;this.Pd=this.tc=this.Ch=this.bb=this.wc=this.rd=this.Ba=this.qf=this.Sa=this.g=this.f=this.ja=this.Ec=this.ia=this.Ra=this.o=this.Hf=this.T=this.j=this.da=this.w=this.t=this.e=this.p=f;this.reset()};
s.tb.prototype={te:0,wh:1,vd:2,reset:function(){this.p=Array(65536);for(var a=0;a<8192;++a)this.p[a]=255;for(var b=0;b<4;++b)a=b*2048,this.p[a+8]=247,this.p[a+9]=239,this.p[a+10]=223,this.p[a+15]=191;for(a=8193;a<this.p.length;++a)this.p[a]=0;this.w=this.t=this.e=0;this.da=511;this.T=this.j=32767;this.Hf=40;this.Bi(40);this.Ra=this.o=0;this.Ec=this.ia=1;this.f=this.ja=0;this.rd=this.Ba=this.qf=this.Sa=this.g=1;this.wc=(new s.tb.Ff).wc;this.bb=0;this.tc=this.Ch=!1;this.Pd=f},Jh:function(){var a,b;
if(this.tc){a=this.o|(this.g===0?1:0)<<1|this.ia<<2|this.Ra<<3|this.Ba<<4|this.Sa<<5|this.ja<<6|this.f<<7;this.T=this.j;this.Ec=this.ia;switch(this.Pd){case 0:if(this.ia!=0)break;this.Eh(a);break;case 1:this.Fh(a);break;case 2:this.Gh()}this.j=this.T;this.ia=this.Ec;this.Ba=this.rd;this.tc=!1}a=this.wc[this.a.m.load(this.j+1)];var c=a>>24;b=0;var e=a>>8&255,g=this.j;this.j+=a>>16&255;var d=0;switch(e){case 0:d=this.load(g+2);break;case 1:d=this.load(g+2);d+=d<128?this.j:this.j-256;break;case 3:d=
this.bc(g+2);break;case 4:d=this.e;break;case 5:d=this.j;break;case 6:d=this.load(g+2)+this.t&255;break;case 7:d=this.load(g+2)+this.w&255;break;case 8:d=this.bc(g+2);(d&65280)!=(d+this.t&65280)&&(b=1);d+=this.t;break;case 9:d=this.bc(g+2);(d&65280)!=(d+this.w&65280)&&(b=1);d+=this.w;break;case 10:d=this.load(g+2);(d&65280)!=(d+this.t&65280)&&(b=1);d+=this.t;d&=255;d=this.bc(d);break;case 11:d=this.bc(this.load(g+2));(d&65280)!=(d+this.w&65280)&&(b=1);d+=this.w;break;case 12:d=this.bc(g+2),d=d<8191?
this.p[d]+(this.p[d&65280|(d&255)+1&255]<<8):this.a.m.load(d)+(this.a.m.load(d&65280|(d&255)+1&255)<<8)}d&=65535;switch(a&255){case 0:a=this.e+this.load(d)+this.o;this.ja=((this.e^this.load(d))&128)==0&&((this.e^a)&128)!=0?1:0;this.o=a>255?1:0;this.f=a>>7&1;this.g=a&255;this.e=a&255;c+=b;break;case 1:this.e&=this.load(d);this.f=this.e>>7&1;this.g=this.e;e!=11&&(c+=b);break;case 2:e==4?(this.o=this.e>>7&1,this.e=this.e<<1&255,this.f=this.e>>7&1,this.g=this.e):(a=this.load(d),this.o=a>>7&1,a=a<<1&255,
this.f=a>>7&1,this.g=a,this.write(d,a));break;case 3:if(this.o==0)c+=(g&65280)!=(d&65280)?2:1,this.j=d;break;case 4:if(this.o==1)c+=(g&65280)!=(d&65280)?2:1,this.j=d;break;case 5:if(this.g==0)c+=(g&65280)!=(d&65280)?2:1,this.j=d;break;case 6:a=this.load(d);this.f=a>>7&1;this.ja=a>>6&1;a&=this.e;this.g=a;break;case 7:if(this.f==1)++c,this.j=d;break;case 8:if(this.g!=0)c+=(g&65280)!=(d&65280)?2:1,this.j=d;break;case 9:if(this.f==0)c+=(g&65280)!=(d&65280)?2:1,this.j=d;break;case 10:this.j+=2;this.push(this.j>>
8&255);this.push(this.j&255);this.Ba=1;this.push(this.o|(this.g==0?1:0)<<1|this.ia<<2|this.Ra<<3|this.Ba<<4|this.Sa<<5|this.ja<<6|this.f<<7);this.ia=1;this.j=this.bc(65534);--this.j;break;case 11:if(this.ja==0)c+=(g&65280)!=(d&65280)?2:1,this.j=d;break;case 12:if(this.ja==1)c+=(g&65280)!=(d&65280)?2:1,this.j=d;break;case 13:this.o=0;break;case 14:this.Ra=0;break;case 15:this.ia=0;break;case 16:this.ja=0;break;case 17:a=this.e-this.load(d);this.o=a>=0?1:0;this.f=a>>7&1;this.g=a&255;c+=b;break;case 18:a=
this.t-this.load(d);this.o=a>=0?1:0;this.f=a>>7&1;this.g=a&255;break;case 19:a=this.w-this.load(d);this.o=a>=0?1:0;this.f=a>>7&1;this.g=a&255;break;case 20:a=this.load(d)-1&255;this.f=a>>7&1;this.g=a;this.write(d,a);break;case 21:this.t=this.t-1&255;this.f=this.t>>7&1;this.g=this.t;break;case 22:this.w=this.w-1&255;this.f=this.w>>7&1;this.g=this.w;break;case 23:this.e=(this.load(d)^this.e)&255;this.f=this.e>>7&1;this.g=this.e;c+=b;break;case 24:a=this.load(d)+1&255;this.f=a>>7&1;this.g=a;this.write(d,
a&255);break;case 25:this.t=this.t+1&255;this.f=this.t>>7&1;this.g=this.t;break;case 26:++this.w;this.w&=255;this.f=this.w>>7&1;this.g=this.w;break;case 27:this.j=d-1;break;case 28:this.push(this.j>>8&255);this.push(this.j&255);this.j=d-1;break;case 29:this.e=this.load(d);this.f=this.e>>7&1;this.g=this.e;c+=b;break;case 30:this.t=this.load(d);this.f=this.t>>7&1;this.g=this.t;c+=b;break;case 31:this.w=this.load(d);this.f=this.w>>7&1;this.g=this.w;c+=b;break;case 32:e==4?(a=this.e&255,this.o=a&1,a>>=
1,this.e=a):(a=this.load(d)&255,this.o=a&1,a>>=1,this.write(d,a));this.f=0;this.g=a;break;case 33:break;case 34:a=(this.load(d)|this.e)&255;this.f=a>>7&1;this.e=this.g=a;e!=11&&(c+=b);break;case 35:this.push(this.e);break;case 36:this.Ba=1;this.push(this.o|(this.g==0?1:0)<<1|this.ia<<2|this.Ra<<3|this.Ba<<4|this.Sa<<5|this.ja<<6|this.f<<7);break;case 37:this.e=this.gc();this.f=this.e>>7&1;this.g=this.e;break;case 38:a=this.gc();this.o=a&1;this.g=(a>>1&1)==1?0:1;this.ia=a>>2&1;this.Ra=a>>3&1;this.Ba=
a>>4&1;this.Sa=a>>5&1;this.ja=a>>6&1;this.f=a>>7&1;this.Sa=1;break;case 39:e==4?(a=this.e,b=this.o,this.o=a>>7&1,this.e=a=(a<<1&255)+b):(a=this.load(d),b=this.o,this.o=a>>7&1,a=(a<<1&255)+b,this.write(d,a));this.f=a>>7&1;this.g=a;break;case 40:e==4?(b=this.o<<7,this.o=this.e&1,this.e=a=(this.e>>1)+b):(a=this.load(d),b=this.o<<7,this.o=a&1,a=(a>>1)+b,this.write(d,a));this.f=a>>7&1;this.g=a;break;case 41:a=this.gc();this.o=a&1;this.g=(a>>1&1)==0?1:0;this.ia=a>>2&1;this.Ra=a>>3&1;this.Ba=a>>4&1;this.Sa=
a>>5&1;this.ja=a>>6&1;this.f=a>>7&1;this.j=this.gc();this.j+=this.gc()<<8;if(this.j==65535)return;--this.j;this.Sa=1;break;case 42:this.j=this.gc();this.j+=this.gc()<<8;if(this.j==65535)return;break;case 43:a=this.e-this.load(d)-(1-this.o);this.f=a>>7&1;this.g=a&255;this.ja=((this.e^a)&128)!=0&&((this.e^this.load(d))&128)!=0?1:0;this.o=a<0?0:1;this.e=a&255;e!=11&&(c+=b);break;case 44:this.o=1;break;case 45:this.Ra=1;break;case 46:this.ia=1;break;case 47:this.write(d,this.e);break;case 48:this.write(d,
this.t);break;case 49:this.write(d,this.w);break;case 50:this.t=this.e;this.f=this.e>>7&1;this.g=this.e;break;case 51:this.w=this.e;this.f=this.e>>7&1;this.g=this.e;break;case 52:this.t=this.da-256;this.f=this.da>>7&1;this.g=this.t;break;case 53:this.e=this.t;this.f=this.t>>7&1;this.g=this.t;break;case 54:this.da=this.t+256;this.Hi();break;case 55:this.e=this.w;this.f=this.w>>7&1;this.g=this.w;break;default:this.a.stop(),this.a.Xi="Game crashed, invalid opcode at address $"+g.toString(16)}return c},
load:function(a){return a<8192?this.p[a&2047]:this.a.m.load(a)},bc:function(a){return a<8191?this.p[a&2047]|this.p[a+1&2047]<<8:this.a.m.load(a)|this.a.m.load(a+1)<<8},write:function(a,b){a<8192?this.p[a&2047]=b:this.a.m.write(a,b)},ic:function(a){if(!(this.tc&&a==this.te))this.tc=!0,this.Pd=a},push:function(a){this.a.m.write(this.da,a);--this.da;this.da=256|this.da&255},Hi:function(){this.da=256|this.da&255},gc:function(){++this.da;this.da=256|this.da&255;return this.a.m.load(this.da)},Sf:function(a){this.bb+=
a},Fh:function(a){if((this.a.m.load(8192)&128)!=0)++this.T,this.push(this.T>>8&255),this.push(this.T&255),this.push(a),this.T=this.a.m.load(65530)|this.a.m.load(65531)<<8,--this.T},Gh:function(){this.T=this.a.m.load(65532)|this.a.m.load(65533)<<8;--this.T},Eh:function(a){++this.T;this.push(this.T>>8&255);this.push(this.T&255);this.push(a);this.Ec=1;this.rd=0;this.T=this.a.m.load(65534)|this.a.m.load(65535)<<8;--this.T},Bi:function(a){this.o=a&1;this.g=a>>1&1;this.ia=a>>2&1;this.Ra=a>>3&1;this.Ba=
a>>4&1;this.Sa=a>>5&1;this.ja=a>>6&1;this.f=a>>7&1},Ub:{p:"mem",bb:"cyclesToHalt",tc:"irqRequested",Pd:"irqType",e:"REG_ACC",t:"REG_X",w:"REG_Y",da:"REG_SP",j:"REG_PC",T:"REG_PC_NEW",Hf:"REG_STATUS",o:"F_CARRY",Ra:"F_DECIMAL",ia:"F_INTERRUPT",Ec:"F_INTERRUPT_NEW",ja:"F_OVERFLOW",f:"F_SIGN",g:"F_ZERO",Sa:"F_NOTUSED",qf:"F_NOTUSED_NEW",Ba:"F_BRK",rd:"F_BRK_NEW"},toJSON:function(){return s.Ca.toJSON(this)},F:function(a){s.Ca.F(this,a)}};
s.tb.Ff=function(){this.wc=Array(256);for(var a=0;a<256;++a)this.wc[a]=255;this.b(this.ub,105,this.Aa,2,2);this.b(this.ub,101,this.B,2,3);this.b(this.ub,117,this.S,2,4);this.b(this.ub,109,this.z,3,4);this.b(this.ub,125,this.aa,3,4);this.b(this.ub,121,this.$a,3,4);this.b(this.ub,97,this.rb,2,6);this.b(this.ub,113,this.qb,2,5);this.b(this.vb,41,this.Aa,2,2);this.b(this.vb,37,this.B,2,3);this.b(this.vb,53,this.S,2,4);this.b(this.vb,45,this.z,3,4);this.b(this.vb,61,this.aa,3,4);this.b(this.vb,57,this.$a,
3,4);this.b(this.vb,33,this.rb,2,6);this.b(this.vb,49,this.qb,2,5);this.b(this.Fc,10,this.qd,1,2);this.b(this.Fc,6,this.B,2,5);this.b(this.Fc,22,this.S,2,6);this.b(this.Fc,14,this.z,3,6);this.b(this.Fc,30,this.aa,3,7);this.b(this.Og,144,this.sb,2,2);this.b(this.Pg,176,this.sb,2,2);this.b(this.Qg,240,this.sb,2,2);this.b(this.rf,36,this.B,2,3);this.b(this.rf,44,this.z,3,4);this.b(this.Rg,48,this.sb,2,2);this.b(this.Sg,208,this.sb,2,2);this.b(this.Tg,16,this.sb,2,2);this.b(this.Ug,0,this.v,1,7);this.b(this.Vg,
80,this.sb,2,2);this.b(this.Wg,112,this.sb,2,2);this.b(this.Xg,24,this.v,1,2);this.b(this.Yg,216,this.v,1,2);this.b(this.Zg,88,this.v,1,2);this.b(this.$g,184,this.v,1,2);this.b(this.wb,201,this.Aa,2,2);this.b(this.wb,197,this.B,2,3);this.b(this.wb,213,this.S,2,4);this.b(this.wb,205,this.z,3,4);this.b(this.wb,221,this.aa,3,4);this.b(this.wb,217,this.$a,3,4);this.b(this.wb,193,this.rb,2,6);this.b(this.wb,209,this.qb,2,5);this.b(this.pe,224,this.Aa,2,2);this.b(this.pe,228,this.B,2,3);this.b(this.pe,
236,this.z,3,4);this.b(this.qe,192,this.Aa,2,2);this.b(this.qe,196,this.B,2,3);this.b(this.qe,204,this.z,3,4);this.b(this.td,198,this.B,2,5);this.b(this.td,214,this.S,2,6);this.b(this.td,206,this.z,3,6);this.b(this.td,222,this.aa,3,7);this.b(this.ah,202,this.v,1,2);this.b(this.bh,136,this.v,1,2);this.b(this.xb,73,this.Aa,2,2);this.b(this.xb,69,this.B,2,3);this.b(this.xb,85,this.S,2,4);this.b(this.xb,77,this.z,3,4);this.b(this.xb,93,this.aa,3,4);this.b(this.xb,89,this.$a,3,4);this.b(this.xb,65,this.rb,
2,6);this.b(this.xb,81,this.qb,2,5);this.b(this.ud,230,this.B,2,5);this.b(this.ud,246,this.S,2,6);this.b(this.ud,238,this.z,3,6);this.b(this.ud,254,this.aa,3,7);this.b(this.dh,232,this.v,1,2);this.b(this.eh,200,this.v,1,2);this.b(this.sf,76,this.z,3,3);this.b(this.sf,108,this.Dg,3,5);this.b(this.fh,32,this.z,3,6);this.b(this.yb,169,this.Aa,2,2);this.b(this.yb,165,this.B,2,3);this.b(this.yb,181,this.S,2,4);this.b(this.yb,173,this.z,3,4);this.b(this.yb,189,this.aa,3,4);this.b(this.yb,185,this.$a,3,
4);this.b(this.yb,161,this.rb,2,6);this.b(this.yb,177,this.qb,2,5);this.b(this.Gc,162,this.Aa,2,2);this.b(this.Gc,166,this.B,2,3);this.b(this.Gc,182,this.mf,2,4);this.b(this.Gc,174,this.z,3,4);this.b(this.Gc,190,this.$a,3,4);this.b(this.Hc,160,this.Aa,2,2);this.b(this.Hc,164,this.B,2,3);this.b(this.Hc,180,this.S,2,4);this.b(this.Hc,172,this.z,3,4);this.b(this.Hc,188,this.aa,3,4);this.b(this.Ic,74,this.qd,1,2);this.b(this.Ic,70,this.B,2,5);this.b(this.Ic,86,this.S,2,6);this.b(this.Ic,78,this.z,3,6);
this.b(this.Ic,94,this.aa,3,7);this.b(this.gh,234,this.v,1,2);this.b(this.zb,9,this.Aa,2,2);this.b(this.zb,5,this.B,2,3);this.b(this.zb,21,this.S,2,4);this.b(this.zb,13,this.z,3,4);this.b(this.zb,29,this.aa,3,4);this.b(this.zb,25,this.$a,3,4);this.b(this.zb,1,this.rb,2,6);this.b(this.zb,17,this.qb,2,5);this.b(this.hh,72,this.v,1,3);this.b(this.ih,8,this.v,1,3);this.b(this.jh,104,this.v,1,4);this.b(this.kh,40,this.v,1,4);this.b(this.Jc,42,this.qd,1,2);this.b(this.Jc,38,this.B,2,5);this.b(this.Jc,54,
this.S,2,6);this.b(this.Jc,46,this.z,3,6);this.b(this.Jc,62,this.aa,3,7);this.b(this.Kc,106,this.qd,1,2);this.b(this.Kc,102,this.B,2,5);this.b(this.Kc,118,this.S,2,6);this.b(this.Kc,110,this.z,3,6);this.b(this.Kc,126,this.aa,3,7);this.b(this.lh,64,this.v,1,6);this.b(this.mh,96,this.v,1,6);this.b(this.Ab,233,this.Aa,2,2);this.b(this.Ab,229,this.B,2,3);this.b(this.Ab,245,this.S,2,4);this.b(this.Ab,237,this.z,3,4);this.b(this.Ab,253,this.aa,3,4);this.b(this.Ab,249,this.$a,3,4);this.b(this.Ab,225,this.rb,
2,6);this.b(this.Ab,241,this.qb,2,5);this.b(this.nh,56,this.v,1,2);this.b(this.oh,248,this.v,1,2);this.b(this.ph,120,this.v,1,2);this.b(this.Tb,133,this.B,2,3);this.b(this.Tb,149,this.S,2,4);this.b(this.Tb,141,this.z,3,4);this.b(this.Tb,157,this.aa,3,5);this.b(this.Tb,153,this.$a,3,5);this.b(this.Tb,129,this.rb,2,6);this.b(this.Tb,145,this.qb,2,6);this.b(this.re,134,this.B,2,3);this.b(this.re,150,this.mf,2,4);this.b(this.re,142,this.z,3,4);this.b(this.se,132,this.B,2,3);this.b(this.se,148,this.S,
2,4);this.b(this.se,140,this.z,3,4);this.b(this.qh,170,this.v,1,2);this.b(this.rh,168,this.v,1,2);this.b(this.sh,186,this.v,1,2);this.b(this.th,138,this.v,1,2);this.b(this.uh,154,this.v,1,2);this.b(this.vh,152,this.v,1,2);this.Yi=[7,6,2,8,3,3,5,5,3,2,2,2,4,4,6,6,2,5,2,8,4,4,6,6,2,4,2,7,4,4,7,7,6,6,2,8,3,3,5,5,4,2,2,2,4,4,6,6,2,5,2,8,4,4,6,6,2,4,2,7,4,4,7,7,6,6,2,8,3,3,5,5,3,2,2,2,3,4,6,6,2,5,2,8,4,4,6,6,2,4,2,7,4,4,7,7,6,6,2,8,3,3,5,5,4,2,2,2,5,4,6,6,2,5,2,8,4,4,6,6,2,4,2,7,4,4,7,7,2,6,2,6,3,3,3,
3,2,2,2,2,4,4,4,4,2,6,2,6,4,4,4,4,2,5,2,5,5,5,5,5,2,6,2,6,3,3,3,3,2,2,2,2,4,4,4,4,2,5,2,5,4,4,4,4,2,4,2,4,4,4,4,4,2,6,2,8,3,3,5,5,2,2,2,2,4,4,6,6,2,5,2,8,4,4,6,6,2,4,2,7,4,4,7,7,2,6,3,8,3,3,5,5,2,2,2,2,4,4,6,6,2,5,2,8,4,4,6,6,2,4,2,7,4,4,7,7];this.d=Array(56);this.d[0]="ADC";this.d[1]="AND";this.d[2]="ASL";this.d[3]="BCC";this.d[4]="BCS";this.d[5]="BEQ";this.d[6]="BIT";this.d[7]="BMI";this.d[8]="BNE";this.d[9]="BPL";this.d[10]="BRK";this.d[11]="BVC";this.d[12]="BVS";this.d[13]="CLC";this.d[14]="CLD";
this.d[15]="CLI";this.d[16]="CLV";this.d[17]="CMP";this.d[18]="CPX";this.d[19]="CPY";this.d[20]="DEC";this.d[21]="DEX";this.d[22]="DEY";this.d[23]="EOR";this.d[24]="INC";this.d[25]="INX";this.d[26]="INY";this.d[27]="JMP";this.d[28]="JSR";this.d[29]="LDA";this.d[30]="LDX";this.d[31]="LDY";this.d[32]="LSR";this.d[33]="NOP";this.d[34]="ORA";this.d[35]="PHA";this.d[36]="PHP";this.d[37]="PLA";this.d[38]="PLP";this.d[39]="ROL";this.d[40]="ROR";this.d[41]="RTI";this.d[42]="RTS";this.d[43]="SBC";this.d[44]=
"SEC";this.d[45]="SED";this.d[46]="SEI";this.d[47]="STA";this.d[48]="STX";this.d[49]="STY";this.d[50]="TAX";this.d[51]="TAY";this.d[52]="TSX";this.d[53]="TXA";this.d[54]="TXS";this.d[55]="TYA";this.Ui=["Zero Page           ","Relative            ","Implied             ","Absolute            ","Accumulator         ","Immediate           ","Zero Page,X         ","Zero Page,Y         ","Absolute,X          ","Absolute,Y          ","Preindexed Indirect ","Postindexed Indirect","Indirect Absolute   "]};
s.tb.Ff.prototype={ub:0,vb:1,Fc:2,Og:3,Pg:4,Qg:5,rf:6,Rg:7,Sg:8,Tg:9,Ug:10,Vg:11,Wg:12,Xg:13,Yg:14,Zg:15,$g:16,wb:17,pe:18,qe:19,td:20,ah:21,bh:22,xb:23,ud:24,dh:25,eh:26,sf:27,fh:28,yb:29,Gc:30,Hc:31,Ic:32,gh:33,zb:34,hh:35,ih:36,jh:37,kh:38,Jc:39,Kc:40,lh:41,mh:42,Ab:43,nh:44,oh:45,ph:46,Tb:47,re:48,se:49,qh:50,rh:51,sh:52,th:53,uh:54,vh:55,B:0,sb:1,v:2,z:3,qd:4,Aa:5,S:6,mf:7,aa:8,$a:9,rb:10,qb:11,Dg:12,b:function(a,b,c,e,g){this.wc[b]=a&255|(c&255)<<8|(e&255)<<16|(g&255)<<24}};s.mc=function(){var a;this.W={tf:0,uf:1,yf:2,zf:3,Af:4,vf:5,wf:6,xf:7};this.Oa=Array(8);for(a=0;a<this.Oa.length;++a)this.Oa[a]=64;this.Pa=Array(8);for(a=0;a<this.Pa.length;++a)this.Pa[a]=64};
s.mc.prototype={qg:function(a,b){switch(a){case 88:this.Oa[this.W.tf]=b;break;case 90:this.Oa[this.W.uf]=b;break;case 17:this.Oa[this.W.yf]=b;break;case 13:this.Oa[this.W.zf]=b;break;case 38:this.Oa[this.W.Af]=b;break;case 40:this.Oa[this.W.vf]=b;break;case 37:this.Oa[this.W.wf]=b;break;case 39:this.Oa[this.W.xf]=b;break;case 103:this.Pa[this.W.tf]=b;break;case 105:this.Pa[this.W.uf]=b;break;case 99:this.Pa[this.W.yf]=b;break;case 97:this.Pa[this.W.zf]=b;break;case 104:this.Pa[this.W.Af]=b;break;
case 98:this.Pa[this.W.vf]=b;break;case 100:this.Pa[this.W.wf]=b;break;case 102:this.Pa[this.W.xf]=b;break;default:return!0}return!1},Uf:function(a){!this.qg(a.keyCode,65)&&a.preventDefault&&a.preventDefault()},Wf:function(a){!this.qg(a.keyCode,64)&&a.preventDefault&&a.preventDefault()},Vf:function(a){a.preventDefault()}};s.l={};s.l[0]=h("a");
s.l[0].prototype={reset:function(){this.Qd=this.Ib=this.Hb=0;this.Vd=!1;this.Xd=this.Wd=f},write:function(a,b){a<8192?this.a.i.p[a&2047]=b:a>16407?this.a.i.p[a]=b:a>8199&&a<16384?this.gg(8192+(a&7),b):this.gg(a,b)},load:function(a){a&=65535;return a>16407?this.a.i.p[a]:a>=8192?this.qi(a):this.a.i.p[a&2047]},qi:function(a){switch(a>>12){case 2:case 3:switch(a&7){case 0:return this.a.i.p[8192];case 1:return this.a.i.p[8193];case 2:return this.a.q.pi();case 3:return 0;case 4:return this.a.q.Fi();case 5:return 0;
case 6:return 0;case 7:return this.a.q.Oi()}break;case 4:switch(a-16405){case 0:return this.a.G.dg(a);case 1:return this.fi();case 2:if(this.Vd){for(var a=Math.max(0,this.Wd-4),b=Math.min(256,this.Wd+4),c=Math.min(240,this.Xd+4),e=0,g=Math.max(0,this.Xd-4);g<c;++g)for(var d=a;d<b;++d)if(this.a.q.buffer[(g<<8)+d]==16777215){e|=8;console.debug("Clicked on white!");break}e|=this.Vd?16:0;return(this.Tf()|e)&65535}else return this.Tf()}}return 0},gg:function(a,b){switch(a){case 8192:this.a.i.p[a]=b;this.a.q.yg(b);
break;case 8193:this.a.i.p[a]=b;this.a.q.zg(b);break;case 8195:this.a.q.Si(b);break;case 8196:this.a.q.Gi(b);break;case 8197:this.a.q.wi(b);break;case 8198:this.a.q.Ti(b);break;case 8199:this.a.q.Pi(b);break;case 16404:this.a.q.Ei(b);break;case 16405:this.a.G.P(a,b);break;case 16406:if(b===0&&this.Qd===1)this.Ib=this.Hb=0;this.Qd=b;break;case 16407:this.a.G.P(a,b);break;default:a>=16384&&a<=16407&&this.a.G.P(a,b)}},fi:function(){var a;switch(this.Hb){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:a=
this.a.Xc.Oa[this.Hb];break;case 8:case 9:case 10:case 11:case 12:case 13:case 14:case 15:case 16:case 17:case 18:a=0;break;case 19:a=1;break;default:a=0}++this.Hb;if(this.Hb==24)this.Hb=0;return a},Tf:function(){var a;switch(this.Ib){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:a=this.a.Xc.Pa[this.Ib];break;case 8:case 9:case 10:case 11:case 12:case 13:case 14:case 15:case 16:case 17:case 18:a=0;break;case 19:a=1;break;default:a=0}++this.Ib;if(this.Ib==24)this.Ib=0;return a},vc:function(){!this.a.c.Rb||
this.a.c.J<1?alert("NoMapper: Invalid ROM! Unable to load."):(this.ii(),this.Td(),this.Pe(),this.a.i.ic(this.a.i.vd))},ii:function(){this.a.c.J>1?(this.pa(0,32768),this.pa(1,49152)):(this.pa(0,32768),this.pa(0,49152))},Td:function(){this.a.c.D>0&&(this.a.c.D==1?(this.Ua(0,0),this.Ua(0,4096)):(this.Ua(0,0),this.Ua(1,4096)))},Pe:function(){if(this.a.c.we){var a=this.a.c.we;a!==f&&a.length==8192&&s.Ca.pc(a,0,this.a.i.p,24576,8192)}},pa:function(a,b){a%=this.a.c.J;s.Ca.pc(this.a.c.c[a],0,this.a.i.p,b,
16384)},Ua:function(a,b){this.a.c.D!==0&&(this.a.q.ob(),s.Ca.pc(this.a.c.pb[a%this.a.c.D],0,this.a.q.Z,b,4096),s.Ca.pc(this.a.c.lc[a%this.a.c.D],0,this.a.q.O,b>>4,256))},gi:function(a,b){this.pa(a*2%this.a.c.J,b);this.pa((a*2+1)%this.a.c.J,b+16384)},Yf:function(a,b){this.a.c.D!==0&&(this.a.q.ob(),this.Ua(a%this.a.c.D,b),this.Ua((a+1)%this.a.c.D,b+4096))},X:function(a,b){if(this.a.c.D!==0){this.a.q.ob();var c=Math.floor(a/4)%this.a.c.D;s.Ca.pc(this.a.c.pb[c],0,this.a.q.Z,a%4*1024,1024);for(var c=this.a.c.lc[c],
e=b>>4,g=0;g<64;++g)this.a.q.O[e+g]=c[(a%4<<6)+g]}},Fa:function(a,b){s.Ca.pc(this.a.c.c[Math.floor(a/2)%this.a.c.J],a%2*8192,this.a.i.p,b,8192)},toJSON:function(){return{joy1StrobeState:this.Hb,joy2StrobeState:this.Ib,joypadLastWrite:this.Qd}},F:function(a){this.Hb=a.joy1StrobeState;this.Ib=a.joy2StrobeState;this.Qd=a.joypadLastWrite}};s.l[1]=h("a");s.l[1].prototype=new s.l[0];
s.l[1].prototype.reset=function(){s.l[0].prototype.reset.apply(this);this.ag=this.ib=this.Kb=this.hc=0;this.bd=this.ad=1;this.ng=this.gd=this.Nb=this.Dc=0};
s.l[1].prototype.write=function(a,b){if(a<32768)s.l[0].prototype.write.apply(this,arguments);else if((b&128)!==0){if(this.hc=this.Kb=0,v(a)===0)this.bd=this.ad=1}else if(this.hc=this.hc&255-(1<<this.Kb)|(b&1)<<this.Kb,++this.Kb,this.Kb==5){var c=this.hc,e;switch(v(a)){case 0:e=c&3;if(e!==this.ib)this.ib=e,(this.ib&2)===0?this.a.q.zc(this.a.c.Jf):(this.ib&1)!==0?this.a.q.zc(this.a.c.sd):this.a.q.zc(this.a.c.wd);this.ad=c>>2&1;this.bd=c>>3&1;this.Dc=c>>4&1;break;case 1:this.Nb=c>>4&1;this.a.c.D>0&&
(this.Dc===0?this.Nb===0?this.Yf(c&15,0):this.Yf(Math.floor(this.a.c.D/2)+(c&15),0):this.Nb===0?this.Ua(c&15,0):this.Ua(Math.floor(this.a.c.D/2)+(c&15),0));break;case 2:this.gd=c>>4&1;this.a.c.D>0&&this.Dc===1&&(this.gd===0?this.Ua(c&15,4096):this.Ua(Math.floor(this.a.c.D/2)+(c&15),4096));break;default:e=0,this.a.c.J>=32?this.Dc===0?this.Nb===1&&(e=16):e=(this.Nb|this.gd<<1)<<3:this.a.c.J>=16&&this.Nb===1&&(e=8),this.bd===0?this.gi(e+(c&15),32768):(c=e*2+(c&15),this.ad===0?this.pa(c,49152):this.pa(c,
32768))}this.Kb=this.hc=0}};function v(a){return a>=32768&&a<=40959?0:a>=40960&&a<=49151?1:a>=49152&&a<=57343?2:3}s.l[1].prototype.vc=function(){this.a.c.Rb?(this.pa(0,32768),this.pa(this.a.c.J-1,49152),this.Td(),this.Pe(),this.a.i.ic(this.a.i.vd)):alert("MMC1: Invalid ROM! Unable to load.")};
s.l[1].prototype.toJSON=function(){var a=s.l[0].prototype.toJSON.apply(this);a.mirroring=this.ib;a.oneScreenMirroring=this.ag;a.prgSwitchingArea=this.ad;a.prgSwitchingSize=this.bd;a.vromSwitchingSize=this.Dc;a.romSelectionReg0=this.Nb;a.romSelectionReg1=this.gd;a.romBankSelect=this.ng;a.regBuffer=this.hc;a.regBufferCounter=this.Kb;return a};
s.l[1].prototype.F=function(a){s.l[0].prototype.F.apply(this,a);this.ib=a.mirroring;this.ag=a.oneScreenMirroring;this.ad=a.prgSwitchingArea;this.bd=a.prgSwitchingSize;this.Dc=a.vromSwitchingSize;this.Nb=a.romSelectionReg0;this.gd=a.romSelectionReg1;this.ng=a.romBankSelect;this.hc=a.regBuffer;this.Kb=a.regBufferCounter};s.l[2]=h("a");s.l[2].prototype=new s.l[0];s.l[2].prototype.write=function(a,b){a<32768?s.l[0].prototype.write.apply(this,arguments):this.pa(b,32768)};
s.l[2].prototype.vc=function(){this.a.c.Rb?(this.pa(0,32768),this.pa(this.a.c.J-1,49152),this.Td(),this.a.i.ic(this.a.i.vd)):alert("UNROM: Invalid ROM! Unable to load.")};s.l[4]=function(a){this.a=a;this.Ig=0;this.Jg=1;this.Eg=2;this.Fg=3;this.Gg=4;this.Hg=5;this.Kg=6;this.Lg=7;this.Od=this.Ke=this.Je=this.bg=this.ab=this.fc=this.Dd=f;this.ec=!1};s.l[4].prototype=new s.l[0];
s.l[4].prototype.write=function(a,b){if(a<32768)s.l[0].prototype.write.apply(this,arguments);else switch(a){case 32768:this.Dd=b&7;var c=b>>6&1;if(c!=this.fc)this.ec=!0;this.fc=c;this.ab=b>>7&1;break;case 32769:c=b;switch(this.Dd){case this.Ig:this.ab===0?(this.X(c,0),this.X(c+1,1024)):(this.X(c,4096),this.X(c+1,5120));break;case this.Jg:this.ab===0?(this.X(c,2048),this.X(c+1,3072)):(this.X(c,6144),this.X(c+1,7168));break;case this.Eg:this.ab===0?this.X(c,4096):this.X(c,0);break;case this.Fg:this.ab===
0?this.X(c,5120):this.X(c,1024);break;case this.Gg:this.ab===0?this.X(c,6144):this.X(c,2048);break;case this.Hg:this.ab===0?this.X(c,7168):this.X(c,3072);break;case this.Kg:if(this.ec)this.fc===0?this.Fa((this.a.c.J-1)*2,49152):this.Fa((this.a.c.J-1)*2,32768),this.ec=!1;this.fc===0?this.Fa(c,32768):this.Fa(c,49152);break;case this.Lg:if(this.Fa(c,40960),this.ec)this.fc===0?this.Fa((this.a.c.J-1)*2,49152):this.Fa((this.a.c.J-1)*2,32768),this.ec=!1}break;case 40960:(b&1)!==0?this.a.q.zc(this.a.c.sd):
this.a.q.zc(this.a.c.wd);break;case 49152:this.Je=b;break;case 49153:this.Ke=b;break;case 57344:this.Od=0;break;case 57345:this.Od=1}};s.l[4].prototype.vc=function(){this.a.c.Rb?(this.Fa((this.a.c.J-1)*2,49152),this.Fa((this.a.c.J-1)*2+1,57344),this.Fa(0,32768),this.Fa(1,40960),this.Td(),this.Pe(),this.a.i.ic(this.a.i.vd)):alert("MMC3: Invalid ROM! Unable to load.")};
s.l[4].prototype.toJSON=function(){var a=s.l[0].prototype.toJSON.apply(this);a.command=this.Dd;a.prgAddressSelect=this.fc;a.chrAddressSelect=this.ab;a.pageNumber=this.bg;a.irqCounter=this.Je;a.irqLatchValue=this.Ke;a.irqEnable=this.Od;a.prgAddressChanged=this.ec;return a};
s.l[4].prototype.F=function(a){s.l[0].prototype.F.apply(this,a);this.Dd=a.command;this.fc=a.prgAddressSelect;this.ab=a.chrAddressSelect;this.bg=a.pageNumber;this.Je=a.irqCounter;this.Ke=a.irqLatchValue;this.Od=a.irqEnable;this.ec=a.prgAddressChanged};s.ba=function(a){this.a=a;this.ya=new s.ba.oe(this,!0);this.za=new s.ba.oe(this,!1);this.ra=new s.ba.pf(this);this.Ga=new s.ba.of(this);this.fa=new s.ba.nf(this);this.$i=f;this.Ld=4;this.Wc=2048;this.Mf=f;this.Lf=8192;this.nc=0;this.og=44100;this.Qb=this.Pb=this.M=this.L=this.Xf=f;this.hd=Array(this.Lf*2);this.Tc=!1;this.Zi=this.Sc=f;this.Nd=this.dj=this.Ki=!1;this.vi=this.ce=this.Zb=this.jd=this.Nc=this.wa=this.Yc=f;this.nb=0;this.ea=this.Ia=this.Xa=this.Ka=this.Ja=f;this.Be=this.Pf=this.he=this.ge=
this.Te=this.Se=0;this.C=256;this.Re=this.Qe=this.Id=this.sg=this.tg=this.wg=this.vg=this.ug=this.cf=this.df=this.gf=this.ff=this.ef=f;this.dc=[80,170,100,150,128];this.zi(this.dc);this.bi();this.ai();this.ci();this.$h();for(a=0;a<20;++a)a===16?this.P(16400,16):this.P(16384+a,0);this.reset()};
s.ba.prototype={reset:function(){this.og=this.a.N.sampleRate;this.ce=Math.floor(1024*this.a.N.CPU_FREQ_NTSC*this.a.N.oi/(this.og*60));this.Zb=Math.floor(14915*this.a.N.oi/60);this.nc=this.jd=0;this.xg(0);this.vi=this.Nc=this.wa=this.Yc=0;this.Wc=2048;this.Nd=this.Tc=!1;this.si();this.ya.reset();this.za.reset();this.ra.reset();this.Ga.reset();this.fa.reset();this.Ia=this.Xa=this.Ka=this.Ja=this.ea=this.nc=0;this.Tc=!1;this.Ld=4;this.Mf=255;this.Ki=!1;this.he=this.ge=this.Te=this.Se=0;this.Qe=-5E5;
this.Re=5E5},dg:function(){var a=0;a|=this.ya.Fb();a|=this.za.Fb()<<1;a|=this.ra.Fb()<<2;a|=this.Ga.Fb()<<3;a|=this.fa.Fb()<<4;a|=(this.Sc&&this.Tc?1:0)<<6;a|=this.fa.Sh()<<7;this.Sc=!1;this.fa.$b=!1;return a&65535},P:function(a,b){if(a>=16384&&a<16388)this.ya.P(a,b);else if(a>=16388&&a<16392)this.za.P(a,b);else if(a>=16392&&a<16396)this.ra.P(a,b);else if(a>=16396&&a<=16399)this.Ga.P(a,b);else if(a===16400)this.fa.P(a,b);else if(a===16401)this.fa.P(a,b);else if(a===16402)this.fa.P(a,b);else if(a===
16403)this.fa.P(a,b);else if(a===16405){this.xg(b);if(b!==0&&this.Wc>0)this.Nd=!0;this.fa.P(a,b)}else if(a===16407)this.Nc=b>>7&1,this.Yc=0,this.Sc=!1,this.Tc=(b>>6&1)===0?!0:!1,this.Nc===0?this.wa=this.Ld=4:(this.Ld=5,this.wa=0,this.Rf())},si:function(){this.wa=this.Nc===0?4:0},xg:function(a){this.Mf=a&65535;this.ya.Ob((a&1)!==0);this.za.Ob((a&2)!==0);this.ra.Ob((a&4)!==0);this.Ga.Ob((a&8)!==0);this.fa.Ob((a&16)!==0)},ze:function(a){if(this.Wc>0&&this.Nd){if(this.Wc-=a,this.Wc<=0)this.Nd=!1}else{a+=
this.Id;var b=this.ce-this.jd;a<<10>b?(this.Id=(a<<10)-b>>10,a-=this.Id):this.Id=0;var c=this.fa,e=this.ra,g=this.ya,d=this.za,b=this.Ga;if(c.isEnabled)for(c.fe-=a<<3;c.fe<=0&&c.Hd>0;)c.fe+=c.Hd,c.Ah();if(e.n>0)for(e.I-=a;e.I<=0;)if(e.I+=e.n+1,e.uc>0&&e.s>0&&(++e.kc,e.kc&=31,e.isEnabled))e.A=e.kc>=16?e.kc&15:15-(e.kc&15),e.A<<=4;g.I-=a;g.I<=0&&(g.I+=g.n+1<<1,++g.Bc,g.Bc&=7,g.Ya());d.I-=a;d.I<=0&&(d.I+=d.n+1<<1,++d.Bc,d.Bc&=7,d.Ya());c=a;if(b.I-c>0)b.I-=c,b.ea+=c,b.xd+=c*b.A;else for(;--c>0;){if(--b.I<=
0&&b.n>0)b.ld<<=1,b.nd=(b.ld<<(b.Ve===0?1:6)^b.ld)&32768,b.nd!==0?(b.ld|=1,b.$d=0,b.A=0):(b.$d=1,b.A=b.isEnabled&&b.s>0?b.C:0),b.I+=b.n;b.xd+=b.A;++b.ea}this.Tc&&this.Sc&&this.a.i.ic(this.a.i.te);this.Yc+=a<<1;this.Yc>=this.Zb&&(this.Yc-=this.Zb,this.Rf());this.zh(a);this.jd+=a<<10;this.jd>=this.ce&&(this.kb(),this.jd-=this.ce)}},zh:function(a){if(this.ra.Ye){this.nb=Math.floor((this.ra.I<<4)/(this.ra.n+1));if(this.nb>16)this.nb=16;if(this.ra.kc>=16)this.nb=16-this.nb;this.nb+=this.ra.A}a===2?(this.Xa+=
this.nb<<1,this.Ia+=this.fa.kb<<1,this.Ja+=this.ya.A<<1,this.Ka+=this.za.A<<1,this.ea+=2):a===4?(this.Xa+=this.nb<<2,this.Ia+=this.fa.kb<<2,this.Ja+=this.ya.A<<2,this.Ka+=this.za.A<<2,this.ea+=4):(this.Xa+=a*this.nb,this.Ia+=a*this.fa.kb,this.Ja+=a*this.ya.A,this.Ka+=a*this.za.A,this.ea+=a)},Rf:function(){++this.wa;if(this.wa>=this.Ld)this.wa=0;if(this.wa===1||this.wa===3)this.ra.oc(),this.ya.oc(),this.za.oc(),this.Ga.oc(),this.ya.Nf(),this.za.Nf();this.wa>=0&&this.wa<4&&(this.ya.Bd(),this.za.Bd(),
this.Ga.Bd(),this.ra.Bh());if(this.wa===3&&this.Nc===0)this.Sc=!0},kb:function(){var a,b;this.ea>0?(this.Ja<<=4,this.Ja=Math.floor(this.Ja/this.ea),this.Ka<<=4,this.Ka=Math.floor(this.Ka/this.ea),this.Xa=Math.floor(this.Xa/this.ea),this.Ia<<=4,this.Ia=Math.floor(this.Ia/this.ea),this.ea=0):(this.Ja=this.ya.A<<4,this.Ka=this.za.A<<4,this.Xa=this.ra.A,this.Ia=this.fa.kb<<4);var c=Math.floor((this.Ga.xd<<4)/this.Ga.ea);this.Ga.xd=c>>4;this.Ga.ea=1;a=this.Ja*this.ef+this.Ka*this.ff>>8;b=3*this.Xa*this.gf+
(c<<1)*this.df+this.Ia*this.cf>>8;a>=this.Pb.length&&(a=this.Pb.length-1);b>=this.Qb.length&&(b=this.Qb.length-1);var e=this.Pb[a]+this.Qb[b]-this.Be;a=this.Ja*this.ug+this.Ka*this.vg>>8;b=3*this.Xa*this.wg+(c<<1)*this.tg+this.Ia*this.sg>>8;a>=this.Pb.length&&(a=this.Pb.length-1);b>=this.Qb.length&&(b=this.Qb.length-1);a=this.Pb[a]+this.Qb[b]-this.Be;e-=this.Se;this.Se+=e;this.ge+=e-(this.ge>>10);e=this.ge;a-=this.Te;this.Te+=a;this.he+=a-(this.he>>10);a=this.he;if(e>this.Qe)this.Qe=e;if(e<this.Re)this.Re=
e;this.hd[++this.nc]=e;this.hd[++this.nc]=a;if(this.nc===this.hd.length)this.a.ui.Bg(this.hd),this.hd=Array(this.Lf*2),this.nc=0;this.Ia=this.Xa=this.Ka=this.Ja=0},He:function(a){return this.Xf[a>>3]},Qh:function(a){if(a>=0&&a<16)return this.L[a];return 0},Vh:function(a){if(a>=0&&a<16)return this.M[a];return 0},zi:function(a){for(var b=0;b<5;++b)this.dc[b]=a[b];this.Mi()},Mi:function(){this.ef=this.dc[0]*this.C>>8;this.ff=this.dc[1]*this.C>>8;this.gf=this.dc[2]*this.C>>8;this.df=this.dc[3]*this.C>>
8;this.cf=this.dc[4]*this.C>>8;this.ug=this.C-this.ef;this.vg=this.C-this.ff;this.wg=this.C-this.gf;this.tg=this.C-this.df;this.sg=this.C-this.cf},bi:function(){this.Xf=[10,254,20,2,40,4,80,6,160,8,60,10,14,12,26,14,12,16,24,18,48,20,96,22,192,24,72,26,16,28,32,30]},ai:function(){this.L=Array(16);this.L[0]=3424;this.L[1]=3040;this.L[2]=2720;this.L[3]=2560;this.L[4]=2288;this.L[5]=2032;this.L[6]=1808;this.L[7]=1712;this.L[8]=1520;this.L[9]=1280;this.L[10]=1136;this.L[11]=1024;this.L[12]=848;this.L[13]=
672;this.L[14]=576;this.L[15]=432},ci:function(){this.M=Array(16);this.M[0]=4;this.M[1]=8;this.M[2]=16;this.M[3]=32;this.M[4]=64;this.M[5]=96;this.M[6]=128;this.M[7]=160;this.M[8]=202;this.M[9]=254;this.M[10]=380;this.M[11]=508;this.M[12]=762;this.M[13]=1016;this.M[14]=2034;this.M[15]=4068},$h:function(){var a,b,c=0,e=0;this.Pb=Array(512);this.Qb=Array(3264);for(b=0;b<512;++b)a=95.52/(8128/(b/16)+100),a*=0.98411,a*=5E4,a=Math.floor(a),this.Pb[b]=a,a>c&&(c=a);for(b=0;b<3264;++b)a=163.67/(24329/(b/
16)+100),a*=0.98411,a*=5E4,a=Math.floor(a),this.Qb[b]=a,a>e&&(e=a);this.Pf=c+e;this.Be=this.Pf/2}};s.ba.nf=function(a){this.G=a;this.Df=0;this.Cf=1;this.Bf=2;this.Ie=this.isEnabled=f;this.$b=!1;this.data=this.Fd=this.kb=this.fg=this.eg=this.fe=this.Ha=this.xc=this.Jb=this.$c=this.Db=this.Gd=this.Hd=this.yc=f;this.reset()};
s.ba.nf.prototype={Ah:function(){if(this.Ie)(this.data&1)===0?this.Db>0&&--this.Db:this.Db<63&&++this.Db,this.kb=this.isEnabled?(this.Db<<1)+this.Fd:0,this.data>>=1;--this.Gd;if(this.Gd<=0)this.Ie=!1,this.Lh(),this.Gd=8;this.$b&&this.G.a.i.ic(this.G.a.i.te)},Lh:function(){if(this.Ha===0&&this.yc===this.Cf)this.Jb=this.$c,this.Ha=this.xc;if(this.Ha>0&&(this.mi(),this.Ha===0&&this.yc===this.Bf))this.$b=!0},mi:function(){this.data=this.G.a.m.load(this.Jb);this.G.a.i.Sf(4);--this.Ha;++this.Jb;if(this.Jb>
65535)this.Jb=32768;this.Ie=!0},P:function(a,b){if(a===16400){if(b>>6===0)this.yc=this.Df;else if((b>>6&1)===1)this.yc=this.Cf;else if(b>>6===2)this.yc=this.Bf;if((b&128)===0)this.$b=!1;this.Hd=this.G.Qh(b&15)}else if(a===16401)this.Db=b>>1&63,this.Fd=b&1,this.kb=(this.Db<<1)+this.Fd;else if(a===16402)this.Jb=this.$c=b<<6|49152,this.eg=b;else if(a===16403)this.Ha=this.xc=(b<<4)+1,this.fg=b;else if(a===16405)(b>>4&1)===0?this.Ha=0:(this.Jb=this.$c,this.Ha=this.xc),this.$b=!1},Ob:function(a){if(!this.isEnabled&&
a)this.Ha=this.xc;this.isEnabled=a},Fb:function(){return this.Ha===0||!this.isEnabled?0:1},Sh:function(){return this.$b?1:0},reset:function(){this.$b=this.isEnabled=!1;this.yc=this.Df;this.data=this.fg=this.eg=this.fe=this.Fd=this.kb=this.Ha=this.xc=this.Jb=this.$c=this.Db=this.Gd=this.Hd=0}};
s.ba.of=function(a){this.G=a;this.C=this.ga=this.cb=this.oa=this.n=this.I=this.s=this.Ci=this.Xb=this.Ea=this.Wb=this.eb=this.isEnabled=f;this.ld=16384;this.A=this.Ve=this.$d=f;this.xd=0;this.ea=1;this.nd=f;this.reset()};
s.ba.of.prototype={reset:function(){this.n=this.I=0;this.isEnabled=!1;this.s=0;this.Ci=this.Wb=this.eb=this.Ea=!1;this.C=this.ga=this.cb=this.oa=0;this.ld=1;this.nd=this.A=this.Ve=this.$d=0},oc:function(){this.Ea&&this.s>0&&(--this.s,this.s===0&&this.Ya())},Bd:function(){if(this.Xb)this.Xb=!1,this.cb=this.oa+1,this.ga=15;else if(--this.cb<=0)this.cb=this.oa+1,this.ga>0?--this.ga:this.ga=this.Wb?15:0;this.C=this.eb?this.oa:this.ga;this.Ya()},Ya:function(){if(this.isEnabled&&this.s>0)this.A=this.$d*
this.C},P:function(a,b){if(a===16396)this.eb=(b&16)!==0,this.oa=b&15,this.Wb=(b&32)!==0,this.Ea=(b&32)===0,this.C=this.eb?this.oa:this.ga;else if(a===16398)this.n=this.G.Vh(b&15),this.Ve=b>>7;else if(a===16399)this.s=this.G.He(b&248),this.Xb=!0},Ob:function(a){this.isEnabled=a;if(!a)this.s=0;this.Ya()},Fb:function(){return this.s===0||!this.isEnabled?0:1}};
s.ba.oe=function(a,b){this.G=a;this.Hh=[0,1,0,0,0,0,0,0,0,1,1,0,0,0,0,0,0,1,1,1,1,0,0,0,1,0,0,1,1,1,1,1];this.aj=[1,-1,0,0,0,0,0,0,1,0,-1,0,0,0,0,0,1,0,0,0,-1,0,0,0,-1,0,1,0,0,0,0,0];this.rg=b;this.Ni=this.A=this.fj=this.Ce=this.C=this.ga=this.cb=this.oa=this.Cc=this.le=this.ke=this.je=this.Bc=this.s=this.n=this.I=this.kf=this.jf=this.Xb=this.Wb=this.eb=this.hf=this.Ea=this.isEnabled=f;this.reset()};
s.ba.oe.prototype={reset:function(){this.Ni=this.Ce=this.C=this.ga=this.cb=this.oa=this.Cc=this.le=this.ke=this.je=this.Bc=this.s=this.n=this.I=0;this.Wb=this.eb=this.jf=this.hf=this.Ea=this.isEnabled=!1},oc:function(){this.Ea&&this.s>0&&(--this.s,this.s===0&&this.Ya())},Bd:function(){if(this.Xb)this.Xb=!1,this.cb=this.oa+1,this.ga=15;else if(--this.cb<=0)this.cb=this.oa+1,this.ga>0?--this.ga:this.ga=this.Wb?15:0;this.C=this.eb?this.oa:this.ga;this.Ya()},Nf:function(){if(--this.je<=0&&(this.je=this.ke+
1,this.hf&&this.Cc>0&&this.n>7))if(this.jf=!1,this.le===0){if(this.n+=this.n>>this.Cc,this.n>4095)this.n=4095,this.jf=!0}else this.n-=(this.n>>this.Cc)-(this.rg?1:0);if(this.kf)this.kf=!1,this.je=this.ke+1},Ya:function(){this.A=this.isEnabled&&this.s>0&&this.n>7?this.le===0&&this.n+(this.n>>this.Cc)>4095?0:this.C*this.Hh[(this.Ce<<3)+this.Bc]:0},P:function(a,b){var c=this.rg?0:4;if(a===16384+c)this.eb=(b&16)!==0,this.oa=b&15,this.Wb=(b&32)!==0,this.Ce=b>>6&3,this.Ea=(b&32)===0,this.C=this.eb?this.oa:
this.ga,this.Ya();else if(a===16385+c)this.hf=(b&128)!==0,this.ke=b>>4&7,this.le=b>>3&1,this.Cc=b&7,this.kf=!0;else if(a===16386+c)this.n&=1792,this.n|=b;else if(a===16387+c){this.n&=255;this.n|=(b&7)<<8;if(this.isEnabled)this.s=this.G.He(b&248);this.Xb=!0}},Ob:function(a){this.isEnabled=a;if(!a)this.s=0;this.Ya()},Fb:function(){return this.s===0||!this.isEnabled?0:1}};
s.ba.pf=function(a){this.G=a;this.nd=this.A=this.Ne=this.uc=this.s=this.kc=this.n=this.I=this.Rd=this.Sd=this.Ea=this.Ye=this.isEnabled=f;this.reset()};
s.ba.pf.prototype={reset:function(){this.kc=this.n=this.I=0;this.Ye=this.isEnabled=!1;this.s=0;this.Ea=!1;this.Ne=this.uc=0;this.Sd=!0;this.Rd=!1;this.nd=0;this.A=15},oc:function(){this.Ea&&this.s>0&&(--this.s,this.s===0&&this.od())},Bh:function(){this.Sd?(this.uc=this.Ne,this.od()):this.uc>0&&(--this.uc,this.od());if(!this.Rd)this.Sd=!1},Fb:function(){return this.s===0||!this.isEnabled?0:1},dg:function(){return 0},P:function(a,b){if(a===16392)this.Rd=(b&128)!==0,this.Ne=b&127,this.Ea=!this.Rd;else if(a===
16394)this.n&=1792,this.n|=b;else if(a===16395)this.n&=255,this.n|=(b&7)<<8,this.s=this.G.He(b&248),this.Sd=!0;this.od()},Ob:function(a){this.isEnabled=a;if(!a)this.s=0;this.od()},od:function(){this.Ye=this.isEnabled&&this.n>7&&this.uc>0&&this.s>0}};s.ca=function(a){this.a=a;this.cc=this.Za=this.jb=this.qc=this.k=this.O=this.Vc=this.jc=this.Uc=this.Ma=this.La=this.xe=this.Gb=this.sa=this.Ac=this.Na=this.u=this.na=this.Vb=this.gb=this.K=this.pg=this.Sb=this.qa=this.zd=this.cg=this.buffer=this.Bb=this.Cb=this.ae=this.cd=this.Wa=this.ha=this.Va=this.Mb=this.Lb=this.va=this.Q=this.ka=this.la=this.ta=this.Yb=this.Jd=this.Kd=this.Eb=this.Ta=this.Pc=this.Fe=this.rc=this.Qc=this.Ee=this.sc=this.Ge=this.de=this.Zc=this.Sb=this.Oc=this.$f=this.dd=this.qc=
this.mb=this.fb=this.ne=this.pd=this.Y=this.lb=this.Z=f;this.Di=!1;this.ye=!0;this.reset()};
s.ca.prototype={Kf:6,ue:7,reset:function(){var a;this.Z=Array(32768);this.lb=Array(256);for(a=0;a<this.Z.length;++a)this.Z[a]=0;for(a=0;a<this.lb.length;++a)this.lb[a]=0;this.pd=this.Y=f;this.ne=0;this.fb=!0;this.mb=0;this.qc=-1;this.Sb=this.Oc=this.$f=this.dd=!1;this.Zc=0;this.de=f;this.ae=this.cd=this.Wa=this.ha=this.Va=this.Mb=this.Lb=this.va=this.Q=this.ka=this.la=this.ta=this.Yb=this.Jd=this.Kd=this.Eb=this.Ta=this.Pc=this.Fe=this.rc=this.Qc=this.Ee=this.sc=this.Ge=0;this.Cb=f;this.Bb=Array(32);
this.buffer=Array(61440);this.cg=Array(61440);this.zd=Array(61440);this.qa=Array(61440);this.Sb=f;this.pg=Array(32);this.K=0;this.gb=-1;this.Vb=0;this.na=Array(64);this.u=Array(64);this.Na=Array(64);this.Ac=Array(64);this.sa=Array(64);this.Gb=Array(64);this.xe=Array(64);this.Ma=this.La=0;this.Uc=!1;this.jc=Array(16);this.Vc=Array(16);this.O=Array(512);for(a=0;a<512;++a)this.O[a]=new s.ca.ve;this.k=Array(4);this.qc=-1;this.jb=Array(4);for(a=0;a<4;++a)this.jb[a]=new s.ca.Ef(32,32,"Nt"+a);this.Za=Array(32768);
for(a=0;a<32768;++a)this.Za[a]=a;this.cc=new s.ca.Gf;this.cc.hi();this.yg(0);this.zg(0)},zc:function(a){if(a!=this.qc){this.qc=a;this.ob();if(this.Za===f)this.Za=Array(32768);for(var b=0;b<32768;++b)this.Za[b]=b;this.V(16160,16128,32);this.V(16192,16128,32);this.V(16256,16128,32);this.V(16320,16128,32);this.V(12288,8192,3840);this.V(16384,0,16384);a==this.a.c.sd?(this.k[0]=0,this.k[1]=0,this.k[2]=1,this.k[3]=1,this.V(9216,8192,1024),this.V(11264,10240,1024)):a==this.a.c.wd?(this.k[0]=0,this.k[1]=
1,this.k[2]=0,this.k[3]=1,this.V(10240,8192,1024),this.V(11264,9216,1024)):a==this.a.c.Jf?(this.k[0]=0,this.k[1]=0,this.k[2]=0,this.k[3]=0,this.V(9216,8192,1024),this.V(10240,8192,1024),this.V(11264,8192,1024)):a==this.a.c.yh?(this.k[0]=1,this.k[1]=1,this.k[2]=1,this.k[3]=1,this.V(9216,9216,1024),this.V(10240,9216,1024),this.V(11264,9216,1024)):(this.k[0]=0,this.k[1]=1,this.k[2]=2,this.k[3]=3)}},V:function(a,b,c){for(var e=0;e<c;++e)this.Za[a+e]=b+e},Ji:function(){this.a.i.ic(this.a.i.wh);this.gb<
239&&this.jg(this.gb+1,240-this.gb);this.Kh();this.gb=-1},Mh:function(){switch(this.K){case 19:if(this.Oc)this.Vb=1,this.Oc=!this.Oc;break;case 20:this.kd(this.ue,!1);this.kd(this.Kf,!1);this.Uc=!1;this.Ma=this.La=-1;if(this.Eb==1||this.Ta==1)this.ta=this.Lb,this.la=this.Mb,this.ka=this.Va,this.Q=this.ha,this.va=this.Wa,this.Eb==1&&this.ig(!1,0);this.Eb==1&&this.Ta==1&&this.Mc(0);break;case 261:this.kd(this.ue,!0);this.dd=!0;this.Zc=9;this.K=-1;break;default:if(this.K>=21&&this.K<=260&&this.Eb==1){if(!this.de)this.va=
this.Wa,this.ka=this.Va,this.ig(!0,this.K+1-21);this.de=!1;if(!this.Uc&&this.Ta==1&&this.na[0]>=-7&&this.na[0]<256&&this.u[0]+1<=this.K-20&&this.u[0]+1+(this.sc===0?8:16)>=this.K-20&&this.Mc(this.K-20))this.Uc=!0}}++this.K;this.Xe();this.Cd()},Ii:function(){var a=0;if(this.Yb===0)a=this.Vc[0];else switch(this.Pc){case 0:a=0;break;case 1:a=65280;break;case 2:a=16711680;break;case 3:a=0;break;case 4:a=255;break;default:a=0}var b=this.buffer,c;for(c=0;c<61440;++c)b[c]=a;a=this.qa;for(c=0;c<a.length;++c)a[c]=
65},Kh:function(){var a,b,c=this.buffer;if(this.Di){if(this.na[0]>=0&&this.na[0]<256&&this.u[0]>=0&&this.u[0]<240){for(a=0;a<256;++a)c[(this.u[0]<<8)+a]=16733525;for(a=0;a<240;++a)c[(a<<8)+this.na[0]]=16733525}if(this.La>=0&&this.La<256&&this.Ma>=0&&this.Ma<240){for(a=0;a<256;++a)c[(this.Ma<<8)+a]=5635925;for(a=0;a<240;++a)c[(a<<8)+this.La]=5635925}}if(this.ye||this.Jd===0||this.Kd===0)for(b=0;b<240;++b)for(a=0;a<8;++a)c[(b<<8)+a]=0;if(this.ye)for(b=0;b<240;++b)for(a=0;a<8;++a)c[(b<<8)+255-a]=0;if(this.ye)for(b=
0;b<8;++b)for(a=0;a<256;++a)c[(b<<8)+a]=0,c[(239-b<<8)+a]=0;this.a.N.showDisplay&&this.a.ui.Cg(c,this.cg)},yg:function(a){this.ob();this.Ge=a>>7&1;this.sc=a>>5&1;this.Ee=a>>4&1;this.Qc=a>>3&1;this.rc=a>>2&1;this.Fe=a&3;this.Mb=a>>1&1;this.Va=a&1;this.ae=a>>4&1},zg:function(a){this.ob();this.Pc=a>>5&7;this.Ta=a>>4&1;this.Eb=a>>3&1;this.Kd=a>>2&1;this.Jd=a>>1&1;this.Yb=a&1;this.Yb===0&&this.cc.Ze(this.Pc);this.Ag()},kd:function(a,b){var c=1<<a;this.a.i.p[8194]=this.a.i.p[8194]&255-c|(b?c:0)},pi:function(){var a=
this.a.i.p[8194];this.fb=!0;this.kd(this.ue,!1);return a},Si:h("mb"),Fi:function(){return this.lb[this.mb]},Gi:function(a){this.lb[this.mb]=a;this.$e(this.mb,a);++this.mb;this.mb%=256},wi:function(a){this.ob();this.fb?(this.Wa=a>>3&31,this.cd=a&7):(this.Lb=a&7,this.ha=a>>3&31);this.fb=!this.fb},Ti:function(a){this.fb?(this.Lb=a>>4&3,this.Mb=a>>3&1,this.Va=a>>2&1,this.ha=this.ha&7|(a&3)<<3):(this.ob(),this.ha=this.ha&24|a>>5&7,this.Wa=a&31,this.ta=this.Lb,this.la=this.Mb,this.ka=this.Va,this.Q=this.ha,
this.va=this.Wa,this.Mc(this.K-20));this.fb=!this.fb;this.Cd()},Oi:function(){var a;this.Cd();this.Xe();if(this.Y<=16127)return a=this.ne,this.ne=this.Y<8192?this.Z[this.Y]:this.Zf(this.Y),this.Y+=this.rc==1?32:1,this.Ae(),this.We(),a;a=this.Zf(this.Y);this.Y+=this.rc==1?32:1;this.Ae();this.We();return a},Pi:function(a){this.ob();this.Cd();this.Xe();this.Y>=8192?this.li(this.Y,a):this.Qa(this.Y,a);this.Y+=this.rc==1?32:1;this.We();this.Ae()},Ei:function(a){a*=256;for(var b,c=this.mb;c<256;++c)b=this.a.i.p[a+
c],this.lb[c]=b,this.$e(c,b);this.a.i.Sf(513)},We:function(){var a=this.pd>>8&255;this.Lb=a>>4&7;this.Mb=a>>3&1;this.Va=a>>2&1;this.ha=this.ha&7|(a&3)<<3;a=this.pd&255;this.ha=this.ha&24|a>>5&7;this.Wa=a&31},Ae:function(){var a=this.Y>>8&255;this.ta=a>>4&3;this.la=a>>3&1;this.ka=a>>2&1;this.Q=this.Q&7|(a&3)<<3;a=this.Y&255;this.Q=this.Q&24|a>>5&7;this.va=a&31},Xe:function(){var a=(this.Lb&7)<<4;a|=(this.Mb&1)<<3;a|=(this.Va&1)<<2;a|=this.ha>>3&3;var b=(this.ha&7)<<5;b|=this.Wa&31;this.pd=(a<<8|b)&
32767},Cd:function(){var a=(this.ta&7)<<4;a|=(this.la&1)<<3;a|=(this.ka&1)<<2;a|=this.Q>>3&3;var b=(this.Q&7)<<5;b|=this.va&31;this.Y=(a<<8|b)&32767},Zf:function(a){return this.Z[this.Za[a]]},li:function(a,b){a>=16128&&a<16160?a==16128||a==16144?(this.Qa(16128,b),this.Qa(16144,b)):a==16132||a==16148?(this.Qa(16132,b),this.Qa(16148,b)):a==16136||a==16152?(this.Qa(16136,b),this.Qa(16152,b)):a==16140||a==16156?(this.Qa(16140,b),this.Qa(16156,b)):this.Qa(a,b):a<this.Za.length?this.Qa(this.Za[a],b):alert("Invalid VRAM address: "+
a.toString(16))},ob:function(){if(this.K>=21&&this.K<=260)this.jg(this.gb+1,this.K-21-this.gb),this.gb=this.K-21},jg:function(a,b){this.Ta==1&&this.kg(a,b,!0);if(this.Eb==1){var c=a+b<<8;c>61440&&(c=61440);for(var e=this.buffer,g=this.zd,d=this.qa,i=a<<8;i<c;++i)d[i]>255&&(e[i]=g[i])}this.Ta==1&&this.kg(a,b,!1);this.Sb=!1},ig:function(a,b){var c=this.ae===0?0:256,e=(b<<8)-this.cd;this.Cb=this.k[this.la+this.la+this.ka];this.va=this.Wa;this.ka=this.Va;this.Cb=this.k[this.la+this.la+this.ka];if(b<240&&
b-this.ta>=0){for(var g=this.ta<<3,d=this.pg,i=this.Bb,k=this.O,j=this.jb,m=this.Vc,o=this.qa,n=a?this.zd:this.buffer,l,t,r,p=0;p<32;++p){if(b>=0){this.Sb?(l=d[p],t=l.ma,r=i[p]):(l=k[c+j[this.Cb].Yh(this.va,this.Q)],t=l.ma,r=j[this.Cb].Oh(this.va,this.Q),d[p]=l,i[p]=r);var q=0,u=(p<<3)-this.cd;if(u>-8)if(u<0&&(e-=u,q=-u),l.Zd[this.ta])for(;q<8;++q)n[e]=m[t[g+q]+r],o[e]|=256,++e;else for(;q<8;++q)l=t[g+q],l!==0&&(n[e]=m[l+r],o[e]|=256),++e}if(++this.va==32)this.va=0,++this.ka,this.ka%=2,this.Cb=this.k[(this.la<<
1)+this.ka]}this.Sb=!0}++this.ta;if(this.ta==8){this.ta=0;++this.Q;if(this.Q==30)this.Q=0,++this.la,this.la%=2,this.Cb=this.k[(this.la<<1)+this.ka];else if(this.Q==32)this.Q=0;this.Sb=!1}},kg:function(a,b,c){if(this.Ta===1)for(var e=0;e<64;++e)if(this.xe[e]==c&&this.na[e]>=0&&this.na[e]<256&&this.u[e]+8>=a&&this.u[e]<a+b)if(this.sc===0){this.af=0;this.bf=8;if(this.u[e]<a)this.af=a-this.u[e]-1;if(this.u[e]+8>a+b)this.bf=a+b-this.u[e]+1;this.Qc===0?this.O[this.Na[e]].be(this.buffer,0,this.af,8,this.bf,
this.na[e],this.u[e]+1,this.Ac[e],this.jc,this.Gb[e],this.sa[e],e,this.qa):this.O[this.Na[e]+256].be(this.buffer,0,this.af,8,this.bf,this.na[e],this.u[e]+1,this.Ac[e],this.jc,this.Gb[e],this.sa[e],e,this.qa)}else{var g=this.Na[e];(g&1)!==0&&(g=this.Na[e]-1+256);var d=0,i=8;this.u[e]<a&&(d=a-this.u[e]-1);this.u[e]+8>a+b&&(i=a+b-this.u[e]);this.O[g+(this.sa[e]?1:0)].be(this.buffer,0,d,8,i,this.na[e],this.u[e]+1,this.Ac[e],this.jc,this.Gb[e],this.sa[e],e,this.qa);d=0;i=8;this.u[e]+8<a&&(d=a-(this.u[e]+
8+1));this.u[e]+16>a+b&&(i=a+b-(this.u[e]+8));this.O[g+(this.sa[e]?0:1)].be(this.buffer,0,d,8,i,this.na[e],this.u[e]+1+8,this.Ac[e],this.jc,this.Gb[e],this.sa[e],e,this.qa)}},Mc:function(a){this.Ma=this.La=-1;var b,c=this.Qc===0?0:256,e,g,d;e=this.na[0];b=this.u[0]+1;if(this.sc===0){if(b<=a&&b+8>a&&e>=-7&&e<256)if(c=this.O[this.Na[0]+c],b=this.sa[0]?7-(a-b):a-b,b*=8,d=a*256+e,this.Gb[0])for(g=7;g>=0;--g){if(e>=0&&e<256&&d>=0&&d<61440&&this.qa[d]!==0&&c.ma[b+g]!==0)return this.La=d%256,this.Ma=a,!0;
++e;++d}else for(g=0;g<8;++g){if(e>=0&&e<256&&d>=0&&d<61440&&this.qa[d]!==0&&c.ma[b+g]!==0)return this.La=d%256,this.Ma=a,!0;++e;++d}}else if(b<=a&&b+16>a&&e>=-7&&e<256)if(b=this.sa[0]?15-(a-b):a-b,b<8?c=this.O[this.Na[0]+(this.sa[0]?1:0)+((this.Na[0]&1)!==0?255:0)]:(c=this.O[this.Na[0]+(this.sa[0]?0:1)+((this.Na[0]&1)!==0?255:0)],this.sa[0]?b=15-b:b-=8),b*=8,d=a*256+e,this.Gb[0])for(g=7;g>=0;--g){if(e>=0&&e<256&&d>=0&&d<61440&&this.qa[d]!==0&&c.ma[b+g]!==0)return this.La=d%256,this.Ma=a,!0;++e;++d}else for(g=
0;g<8;++g){if(e>=0&&e<256&&d>=0&&d<61440&&this.qa[d]!==0&&c.ma[b+g]!==0)return this.La=d%256,this.Ma=a,!0;++e;++d}return!1},Qa:function(a,b){this.Z[a]=b;a<8192?(this.Z[a]=b,this.ni(a,b)):a>=8192&&a<9152?this.Yd(this.k[0],a-8192,b):a>=9152&&a<9216?this.yd(this.k[0],a-9152,b):a>=9216&&a<10176?this.Yd(this.k[1],a-9216,b):a>=10176&&a<10240?this.yd(this.k[1],a-10176,b):a>=10240&&a<11200?this.Yd(this.k[2],a-10240,b):a>=11200&&a<11264?this.yd(this.k[2],a-11200,b):a>=11264&&a<12224?this.Yd(this.k[3],a-11264,
b):a>=12224&&a<12288?this.yd(this.k[3],a-12224,b):a>=16128&&a<16160&&this.Ag()},Ag:function(){var a;for(a=0;a<16;++a)this.Vc[a]=this.Yb===0?this.cc.Md(this.Z[16128+a]&63):this.cc.Md(this.Z[16128+a]&32);for(a=0;a<16;++a)this.jc[a]=this.Yb===0?this.cc.Md(this.Z[16144+a]&63):this.cc.Md(this.Z[16144+a]&32)},ni:function(a,b){var c=Math.floor(a/16),e=a%16;e<8?this.O[c].ee(e,b,this.Z[a+8]):this.O[c].ee(e-8,this.Z[a-8],b)},Yd:function(a,b,c){this.jb[a].me[b]=c;this.Mc(this.K-20)},yd:function(a,b,c){this.jb[a].Ri(b,
c)},$e:function(a,b){var c=Math.floor(a/4);c===0&&this.Mc(this.K-20);a%4===0?this.u[c]=b:a%4==1?this.Na[c]=b:a%4==2?(this.sa[c]=(b&128)!==0,this.Gb[c]=(b&64)!==0,this.xe[c]=(b&32)!==0,this.Ac[c]=(b&3)<<2):a%4==3&&(this.na[c]=b)},Ub:{Z:"vramMem",lb:"spriteMem",ta:"cntFV",la:"cntV",ka:"cntH",Q:"cntVT",va:"cntHT",Lb:"regFV",Mb:"regV",Va:"regH",ha:"regVT",Wa:"regHT",cd:"regFH",ae:"regS",Y:"vramAddress",pd:"vramTmpAddress",Ge:"f_nmiOnVblank",sc:"f_spriteSize",Ee:"f_bgPatternTable",Qc:"f_spPatternTable",
rc:"f_addrInc",Fe:"f_nTblAddress",Pc:"f_color",Ta:"f_spVisibility",Eb:"f_bgVisibility",Kd:"f_spClipping",Jd:"f_bgClipping",Yb:"f_dispType",ne:"vramBufferedReadValue",fb:"firstWrite",qc:"currentMirroring",Za:"vramMirrorTable",k:"ntable1",mb:"sramAddress",Uc:"hitSpr0",jc:"sprPalette",Vc:"imgPalette",Vb:"curX",K:"scanline",gb:"lastRenderedScanline",Cb:"curNt",Bb:"attrib",buffer:"buffer",zd:"bgbuffer",qa:"pixrendered",dd:"requestEndFrame",$f:"nmiOk",Oc:"dummyCycleToggle",Zc:"nmiCounter",Sb:"validTileData",
de:"scanlineAlreadyRendered"},toJSON:function(){var a,b=s.Ca.toJSON(this);b.nameTable=[];for(a=0;a<this.jb.length;++a)b.nameTable[a]=this.jb[a].toJSON();b.ptTile=[];for(a=0;a<this.O.length;++a)b.ptTile[a]=this.O[a].toJSON();return b},F:function(a){var b;s.Ca.F(this,a);for(b=0;b<this.jb.length;++b)this.jb[b].F(a.nameTable[b]);for(b=0;b<this.O.length;++b)this.O[b].F(a.ptTile[b]);for(b=0;b<this.lb.length;++b)this.$e(b,this.lb[b])}};
s.ca.Ef=function(a,b,c){this.width=a;this.height=b;this.name=c;this.me=Array(a*b);this.Bb=Array(a*b)};
s.ca.Ef.prototype={Yh:function(a,b){return this.me[b*this.width+a]},Oh:function(a,b){return this.Bb[b*this.width+a]},Ri:function(a,b){for(var c=a%8*4,e=Math.floor(a/8)*4,g,d,i,k=0;k<2;++k)for(var j=0;j<2;++j){g=b>>2*(k*2+j)&3;for(var m=0;m<2;++m)for(var o=0;o<2;++o)d=c+j*2+o,i=e+k*2+m,this.Bb[i*this.width+d]=g<<2&12}},toJSON:function(){return{tile:this.me,attrib:this.Bb}},F:function(a){this.me=a.tile;this.Bb=a.attrib}};s.ca.Gf=function(){this.Ed=Array(64);this.De=Array(8);this.Of=-1};
s.ca.Gf.prototype={reset:function(){this.Ze(0)},hi:function(){this.Ed=[5395026,11796480,10485760,11599933,7602281,91,95,6208,12048,543240,26368,1196544,7153664,0,0,0,12899815,16728064,14421538,16729963,14090399,6818519,6588,21681,27227,35843,43776,2918400,10777088,0,0,0,16316664,16755516,16742785,16735173,16730354,14633471,4681215,46327,57599,58229,259115,7911470,15065624,7895160,0,0,16777215,16773822,16300216,16300248,16758527,16761855,13095423,10148607,8973816,8650717,12122296,16119980,16777136,
16308472,0,0];this.ji();this.Ze(0)},ji:function(){for(var a,b,c,e,g,d,i,k=0;k<8;++k){i=d=g=1;(k&1)!==0&&(i=g=0.75);(k&2)!==0&&(d=g=0.75);(k&4)!==0&&(i=d=0.75);this.De[k]=Array(64);for(e=0;e<64;++e)c=this.Ed[e],a=Math.floor(this.Wh(c)*g),b=Math.floor(this.Rh(c)*d),c=Math.floor(this.Ph(c)*i),this.De[k][e]=this.Xh(a,b,c)}},Ze:function(a){if(a!=this.Of){this.Of=a;for(var b=0;b<64;++b)this.Ed[b]=this.De[a][b]}},Md:function(a){return this.Ed[a]},Wh:function(a){return a>>16&255},Rh:function(a){return a>>
8&255},Ph:function(a){return a&255},Xh:function(a,b,c){return a<<16|b<<8|c}};s.ca.ve=function(){this.ma=Array(64);this.Vi=this.H=this.xa=this.cj=this.bj=this.Zh=this.Qi=this.y=this.x=this.R=this.r=f;this.di=!1;this.Zd=Array(8)};
s.ca.ve.prototype={ee:function(a,b,c){this.di=!0;this.R=a<<3;for(this.x=0;this.x<8;++this.x)this.ma[this.R+this.x]=(b>>7-this.x&1)+((c>>7-this.x&1)<<1),this.ma[this.R+this.x]===0&&(this.Zd[a]=!1)},be:function(a,b,c,e,g,d,i,k,j,m,o,n,l){if(!(d<-7||d>=256||i<-7||i>=240))if(this.Qi=e-b,this.Zh=g-c,d<0&&(b-=d),d+e>=256&&(e=256-d),i<0&&(c-=i),i+g>=240&&(g=240-i),!m&&!o){this.r=(i<<8)+d;for(this.y=this.R=0;this.y<8;++this.y){for(this.x=0;this.x<8;++this.x){if(this.x>=b&&this.x<e&&this.y>=c&&this.y<g&&(this.xa=
this.ma[this.R],this.H=l[this.r],this.xa!==0&&n<=(this.H&255)))a[this.r]=j[this.xa+k],this.H=this.H&3840|n,l[this.r]=this.H;++this.r;++this.R}this.r-=8;this.r+=256}}else if(m&&!o){this.r=(i<<8)+d;this.R=7;for(this.y=0;this.y<8;++this.y){for(this.x=0;this.x<8;++this.x){if(this.x>=b&&this.x<e&&this.y>=c&&this.y<g&&(this.xa=this.ma[this.R],this.H=l[this.r],this.xa!==0&&n<=(this.H&255)))a[this.r]=j[this.xa+k],this.H=this.H&3840|n,l[this.r]=this.H;++this.r;--this.R}this.r-=8;this.r+=256;this.R+=16}}else if(o&&
!m){this.r=(i<<8)+d;this.R=56;for(this.y=0;this.y<8;++this.y){for(this.x=0;this.x<8;++this.x){if(this.x>=b&&this.x<e&&this.y>=c&&this.y<g&&(this.xa=this.ma[this.R],this.H=l[this.r],this.xa!==0&&n<=(this.H&255)))a[this.r]=j[this.xa+k],this.H=this.H&3840|n,l[this.r]=this.H;++this.r;++this.R}this.r-=8;this.r+=256;this.R-=16}}else{this.r=(i<<8)+d;this.R=63;for(this.y=0;this.y<8;++this.y){for(this.x=0;this.x<8;++this.x){if(this.x>=b&&this.x<e&&this.y>=c&&this.y<g&&(this.xa=this.ma[this.R],this.H=l[this.r],
this.xa!==0&&n<=(this.H&255)))a[this.r]=j[this.xa+k],this.H=this.H&3840|n,l[this.r]=this.H;++this.r;--this.R}this.r-=8;this.r+=256}}},toJSON:function(){return{opaque:this.Zd,pix:this.ma}},F:function(a){this.Zd=a.opaque;this.ma=a.pix}};s.If=function(a){this.a=a;this.h=Array(92);for(a=0;a<92;++a)this.h[a]="Unknown Mapper";this.h[0]="Direct Access";this.h[1]="Nintendo MMC1";this.h[2]="UNROM";this.h[3]="CNROM";this.h[4]="Nintendo MMC3";this.h[5]="Nintendo MMC5";this.h[6]="FFE F4xxx";this.h[7]="AOROM";this.h[8]="FFE F3xxx";this.h[9]="Nintendo MMC2";this.h[10]="Nintendo MMC4";this.h[11]="Color Dreams Chip";this.h[12]="FFE F6xxx";this.h[15]="100-in-1 switch";this.h[16]="Bandai chip";this.h[17]="FFE F8xxx";this.h[18]="Jaleco SS8806 chip";
this.h[19]="Namcot 106 chip";this.h[20]="Famicom Disk System";this.h[21]="Konami VRC4a";this.h[22]="Konami VRC2a";this.h[23]="Konami VRC2a";this.h[24]="Konami VRC6";this.h[25]="Konami VRC4b";this.h[32]="Irem G-101 chip";this.h[33]="Taito TC0190/TC0350";this.h[34]="32kB ROM switch";this.h[64]="Tengen RAMBO-1 chip";this.h[65]="Irem H-3001 chip";this.h[66]="GNROM switch";this.h[67]="SunSoft3 chip";this.h[68]="SunSoft4 chip";this.h[69]="SunSoft5 FME-7 chip";this.h[71]="Camerica chip";this.h[78]="Irem 74HC161/32-based";
this.h[91]="Pirate HK-SF3 chip"};
s.If.prototype={wd:0,sd:1,Ng:2,Jf:3,yh:4,Da:f,c:f,pb:f,lc:f,J:f,D:f,ib:f,we:f,Li:f,Qf:f,hb:f,Rb:!1,load:function(a){var b,c;if(a.indexOf("NES\u001a")===-1)this.a.ui.updateStatus("Not a valid NES ROM.");else{this.Da=Array(16);for(b=0;b<16;++b)this.Da[b]=a.charCodeAt(b)&255;this.J=this.Da[4];this.D=this.Da[5]*2;this.ib=(this.Da[6]&1)!==0?1:0;this.we=(this.Da[6]&2)!==0;this.Li=(this.Da[6]&4)!==0;this.Qf=(this.Da[6]&8)!==0;this.hb=this.Da[6]>>4|this.Da[7]&240;c=!1;for(b=8;b<16;++b)if(this.Da[b]!==0){c=
!0;break}c&&(this.hb&=15);this.c=Array(this.J);var e=16;for(b=0;b<this.J;++b){this.c[b]=Array(16384);for(c=0;c<16384;++c){if(e+c>=a.length)break;this.c[b][c]=a.charCodeAt(e+c)&255}e+=16384}this.pb=Array(this.D);for(b=0;b<this.D;++b){this.pb[b]=Array(4096);for(c=0;c<4096;++c){if(e+c>=a.length)break;this.pb[b][c]=a.charCodeAt(e+c)&255}e+=4096}this.lc=Array(this.D);for(b=0;b<this.D;++b){this.lc[b]=Array(256);for(c=0;c<256;++c)this.lc[b][c]=new s.ca.ve}for(a=0;a<this.D;++a)for(b=0;b<4096;++b)c=b>>4,e=
b%16,e<8?this.lc[a][c].ee(e,this.pb[a][b],this.pb[a][b+8]):this.lc[a][c].ee(e-8,this.pb[a][b-8],this.pb[a][b]);this.Rb=!0}},Uh:function(){if(this.Qf)return this.Ng;if(this.ib===0)return this.sd;return this.wd},Th:function(){if(this.hb>=0&&this.hb<this.h.length)return this.h[this.hb];return"Unknown Mapper, "+this.hb},ki:function(){return typeof s.l[this.hb]!=="undefined"},Dh:function(){return this.ki()?new s.l[this.hb](this.a):(this.a.ui.updateStatus("This ROM uses a mapper not supported by JSNES: "+
this.Th()+"("+this.hb+")"),f)}};s.Mg=function(a){this.a=a;this.enable=function(){};this.updateStatus=function(){};this.Bg=function(){};this.Cg=function(){}};
typeof jQuery!=="undefined"&&function(a){a.fn.xh=function(b){function c(c){var d=this;d.a=c;d.root=a("<div></div>");d.screen=a('<canvas class="nes-screen" width="256" height="240"></canvas>').appendTo(d.root);d.screen[0].getContext?(d.ti=a('<div class="nes-roms"></div>').appendTo(d.root),d.fd=a("<select></select>").appendTo(d.ti),d.controls=a('<div class="nes-controls"></div>').appendTo(d.root),d.U={pause:a('<input type="button" value="pause" class="nes-pause" disabled="disabled">').appendTo(d.controls),
mg:a('<input type="button" value="restart" class="nes-restart" disabled="disabled">').appendTo(d.controls),md:a('<input type="button" value="enable sound" class="nes-enablesound">').appendTo(d.controls),zoom:a('<input type="button" value="zoom in" class="nes-zoom">').appendTo(d.controls)},d.status=a('<p class="nes-status">Booting up...</p>').appendTo(d.root),d.root.appendTo(e),d.fd.change(function(){d.vc()}),d.U.pause.click(function(){d.a.ac?(d.a.stop(),d.updateStatus("Paused"),d.U.pause.attr("value",
"resume")):(d.a.start(),d.U.pause.attr("value","pause"))}),d.U.mg.click(function(){d.a.hg();d.a.start()}),d.U.md.click(function(){d.a.N.emulateSound?(d.a.N.emulateSound=!1,d.U.md.attr("value","enable sound")):(d.a.N.emulateSound=!0,d.U.md.attr("value","disable sound"))}),d.lf=!1,d.U.zoom.click(function(){d.lf?(d.screen.animate({width:"256px",height:"240px"}),d.U.zoom.attr("value","zoom in"),d.lf=!1):(d.screen.animate({width:"512px",height:"480px"}),d.U.zoom.attr("value","zoom out"),d.lf=!0)}),a.offset&&
d.screen.mousedown(function(a){if(d.a.m)d.a.m.Vd=!0,d.a.m.Wd=a.pageX-d.screen.offset().left,d.a.m.Xd=a.pageY-d.screen.offset().top}).mouseup(function(){setTimeout(function(){if(d.a.m)d.a.m.Vd=!1,d.a.m.Wd=0,d.a.m.Xd=0},500)}),typeof b!="undefined"&&d.Ai(b),d.Lc=d.screen[0].getContext("2d"),d.Lc.getImageData?(d.Ad=d.Lc.getImageData(0,0,256,240),d.ri(),a(document).bind("keydown",function(a){d.a.Xc.Uf(a)}).bind("keyup",function(a){d.a.Xc.Wf(a)}).bind("keypress",function(a){d.a.Xc.Vf(a)}),d.Ih=new DynamicAudio({swf:c.N.swfPath+
"dynamicaudio.swf"})):e.html("Your browser doesn't support writing pixels directly to the <code>&lt;canvas&gt;</code> tag. Try the latest versions of Google Chrome, Safari, Opera or Firefox!")):e.html("Your browser doesn't support the <code>&lt;canvas&gt;</code> tag. Try Google Chrome, Safari, Opera or Firefox!")}var e=this;c.prototype={vc:function(){var b=this;b.updateStatus("Downloading...");a.ajax({url:escape(b.fd.val()),xhr:function(){var d=a.ajaxSettings.xhr();typeof d.overrideMimeType!=="undefined"&&
d.overrideMimeType("text/plain; charset=x-user-defined");return b.xhr=d},complete:function(a){s.Ca.ei()?(a=JSNESBinaryToArray(a.responseBody).toArray(),a=String.fromCharCode.apply(void 0,a)):a=a.responseText;b.a.Ud(a);b.a.start();b.enable()}})},ri:function(){this.Lc.fillStyle="black";this.Lc.fillRect(0,0,256,240);for(var a=3;a<this.Ad.data.length-3;a+=4)this.Ad.data[a]=255},enable:function(){this.U.pause.attr("disabled",f);this.a.ac?this.U.pause.attr("value","pause"):this.U.pause.attr("value","resume");
this.U.mg.attr("disabled",f);this.a.N.emulateSound?this.U.md.attr("value","disable sound"):this.U.md.attr("value","enable sound")},updateStatus:function(a){this.status.text(a)},Ai:function(b){this.fd.children().remove();a("<option>Select a ROM...</option>").appendTo(this.fd);for(var d in b)if(b.hasOwnProperty(d)){for(var c=a("<optgroup></optgroup>").attr("label",d),e=0;e<b[d].length;++e)a("<option>"+b[d][e][0]+"</option>").attr("value",b[d][e][1]).appendTo(c);this.fd.append(c)}},Bg:function(a){return this.Ih.writeInt(a)},
Cg:function(a,b){var c=this.Ad.data,e,j,m;for(j=0;j<61440;++j)e=a[j],e!=b[j]&&(m=j*4,c[m]=e&255,c[m+1]=e>>8&255,c[m+2]=e>>16&255,b[j]=e);this.Lc.putImageData(this.Ad,0,0)}};return c}}(jQuery);window.$=$;$.fn.JSNESUI=$.fn.xh;window.JSNES=s;s.prototype.loadRom=s.prototype.Ud;s.prototype.start=s.prototype.start;s.prototype.frame=s.prototype.frame;s.prototype.reloadRom=s.prototype.hg;s.prototype.stop=s.prototype.stop;s.prototype.toJSON=s.prototype.toJSON;s.prototype.fromJSON=s.prototype.F;s.CPU=s.tb;s.CPU.prototype.toJSON=s.tb.prototype.toJSON;s.CPU.prototype.fromJSON=s.tb.prototype.F;s.PPU=s.ca;s.PPU.prototype.toJSON=s.ca.prototype.toJSON;s.PPU.prototype.fromJSON=s.ca.prototype.F;
s.Keyboard=s.mc;s.Keyboard.prototype.keyDown=s.mc.prototype.Uf;s.Keyboard.prototype.keyUp=s.mc.prototype.Wf;s.Keyboard.prototype.keyPress=s.mc.prototype.Vf;s.prototype.isRunning=s.prototype.ac;s.prototype.fpsFrameCount=s.prototype.Rc;s.prototype.limitFrames=s.prototype.Oe;s.prototype.romData=s.prototype.ed;s.prototype.reset=s.prototype.reset;s.prototype.printFps=s.prototype.Ue;s.prototype.resetFps=s.prototype.lg;s.prototype.setFramerate=s.prototype.xi;s.prototype.setLimitFrames=s.prototype.yi;
